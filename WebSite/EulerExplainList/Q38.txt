See explainations in the code comment area: