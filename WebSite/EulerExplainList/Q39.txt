See explaination in the code comment below: